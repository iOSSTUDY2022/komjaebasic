# 2강 iOS 앱 구조 / 코코아 터치 프레임워크

## 목표 : iOS 앱 구조에 대한 이해 및 코코아 터치 프레임워크의 특징 파악

## 정리

- 커스텀 코드와 시스템 프레임워크
    - 시스템 프레임워크 : iOS 기반의 앱이 실행되는 데에 필요한 기반 환경을 제공한다.
    - 커스텀 코드 : 우리가 작성하는 코드.
    - 앱은 둘 사이에서 상호작용한다.
- main()
    - C언어에서 출발한 언어들의 엔트리포인트.
    - 실행 시 두 개의 인자값(argc, argv[])과 AppDelegate 클래스를 이용하여 UIApplicationMain() 함수를 호출하고, 그 결과를 UIApplication 객체를 반환한다. 
    생성된 UIApplication 객체는 UIKit으로 이관된다.
- UIApplicationMain()
    - iOS앱에 속하는 부분의 엔트리포인트.
    - 앱의 핵심객체를 생성하는 프로세스를 핸들링하고, 스토리보드 파일로부터 앱의 유저 인터페이스를 읽으며 우리가 작성한 커스텀 코드를 호출해 줌으로써 앱 생성 초기에 필요한 설정을 구현하게 해준다.
- UIApplication
    - UIApplicationMain() 함수가 생성시킴.
    - 앱의 본체라고 볼 수 있는 개체.
    - 우리가 앱의 기능이라고 생각하는 기능들은 여기에 포함된 하위 객체.
    - 앱을 실행하면 앱 프로세스가 메모리에 등록되는데, 이때의 앱 프로세스가 곧 UIApplication 객체이다.
    - 보통 서브클래싱 없이 그대로 사용한다.
- AppDelegate
    - UIApplication 객체가 커스텀 코드를 처리할 수 있도록 약간의 권한을 부여한 대리인.
    - UIApplication으로부터 위임받은 일부 권한을 이용해 커스텀 코드와 상호작용하는 역할을 담당한다.
    - iOS 내에서 오직 하나의 인스턴스만 생성되도록 시스템적으로 보장받는다.
    - 앱 전체의 생명 주기와 함께한다. (AppDelegate 객체에 데이터를 저장하면 앱이 종료될때까지 계속 데이터 유지가 가능하다.)
- UIApplication-AppDelegate 관계
    - 회장과 비서실
    - UIApplication 객체 : 앱이 해야 할 아주 중요하고 핵심적인 일, 앱의 생명 주기 관리나 이벤트 처리같은 것들을 담당.
    - AppDelegate : 커스텀 코드를 처리.
- C기반 언어의 앱이 실행되는 전체 과정.
    1. main 함수가 실행된다.
    2. main() 함수가 UIApplicationMain() 함수를 호출한다. 
    3. UIApplicationMain() 함수는 앱의 본체에 해당하는 UIApplication 객체를 생성한다.
    4. UIApplication 객체는 Info.plist 파일을 바탕으로 앱에 피룡한 데이터와 객체를 로드한다. 
    5. AppDelegate 객체를 생성하고 UIApplication 객체와 연결한다.
    6. 이벤트 루프를 만드는 등 실행에 필요한 준비를 진행한다.
    7. 실행 완료 직전, 앱 델리게이트의 application(_ :didFinishLaunchingWithOptions:) 메소드를 호출한다.
- 스위프트 기반 프로젝트에서 앱 실행을 위한 표기
    - C언어 기반의 1~5 과정이 타입 어노테이션으로 대체.
        1. @UIApplicationMain 타입 어노테이션을 표시해 시스템에 델리게이트 클래스 정보를 전달. 
        2. 이벤트 루프를 만드는 등 실행에 필요한 준비를 진행한다.
        3. 실행 완료 직전, 앱 델리게이트의 application(_ :didFinishLaunchingWithOptions:) 메소드를 호출한다.
- 앱의 라이프사이클
    - Not Running : 앱이 시작 안했거나 시스템에 의해 종료된 상태.
    - Inactive : 앱이 전면에서 실행 중이지만, 아무런 이벤트를 받지 않고 있는 상태.
    - Active : 앱이 전면에서 실행중이며, 이벤트를 받고 있는 상태.
    - Background : 앱이 백그라운드에 있지만 여전히 코드가 실행되고 있는 상태. 보통은 suspended로 넘어가기 전에 일시적으로 진입한다.
    - Suspendid : 앱이 메모리에 유지되지만 실행되는 코드가 없는 상태. 메모리가 부족한 상태에선 iOS 시스템이 해당 상태의 앱들을 특별한 알림 없이 정리한다.
- 앱의 실행 상태가 변화할 때마다, 앱 객체가 호출하는 ‘앱 델리게이트 안에 정의된 특정 메소드들’
    - application(_:wilFinishLauchingWithOptions:)
    - application(_:didFinishLaunchingWithOptions:)
    - applicationDidBecomeActive(_:)
    - applicationDidEnterBackground(_:)
    - applicationWillTerminate(_:)
- 프레임워크
    - 소프트웨어에서의 프레임워크 : 애플리케이션 제작을 빠르고 편리하게 할 수 있도록 미리 뼈대를 이루는 각종 코드를 제작하여 모아둔 것. ex. UIKit, Foundation...
    - 파운데이션 프레임워크, UIKit 프레임워크 등의 계층 상위에는 코코아 터치 프레임워크 존재.
- 코코아 터치 프레임워크
    - 코코아 터치 프레임워크 : 앱을 만들고 실행할 때 필요한 iOS 기반 기술들과 도구들의 모음.
    - 코코아 터치 프레임워크의 계층관계
        - 상위-하위. 상위일수록 우리가 자주 사용하고, 구체화되어 있다.
        - 대부분의 경우 상위 프레임워크는 하위에 의존적이다.
        - 프레임워크 계층을 통해 간접적으로 하드웨어를 제어할 수 있다.
            1. Cocoa Touch : 애플리케이션을 직접 지원하는 역할. ex. UIKit.
            2. Media : 상위 계층의 코코아 터치 계층에 그래픽 관련 서비스를 제공. 
            3. Core Service : 문자열 처리, 데이터 집합 관리, 네트워크, 주소록 관리, 환경 설정 등 핵심 서비스 + 디바이스의 하드웨어 특성 기반 서비스. ex. Foundation 프레임워크
            4. Core OS : iOS의 운영체제로서 핵심적인 영역. 전원관리, 보완, 네트워크 등.
- 윈도우
    - iOS에서 디바이스의 스크린을 채우는 객체.
    - 항상 유저 인터페이스 표현 계층의 최상위에 위치.
    - 콘텐츠를 가진 뷰를 내부에 배치하여 화면에 출력하는 역할. (여러 개의 뷰들이 윈도우 위에 올려져 Assembled Views가 된다.)
    - 윈도우와 뷰 사이는 뷰 컨트롤러르 통해 연결된다.
    - 이를 위해 윈도우는 하나의 뷰 컨트롤러를 루트 뷰 컨트롤러로 지정한다.
- 씬Scene
    - 스토리보드를 통해 편집하는 뷰 컨트롤러 각자가 담당하는 하나의 화면.
    - ex. A, B 두 개의 씬으로 이루어진 애플리케이션은 각각을 표현할 두 개의 뷰 컨트롤러가 필요하다.
    - 콘텐츠 뷰 컨트롤러 : 씬을 담당하고 콘텐츠를 표시하는 뷰 컨트롤러
    - 각각의 씬은 자신만의 뷰 계층 구조를 가지며, 최상위에는 하나의 루트뷰(컨텐츠뷰)가 존재한다.
- 컨테이너 뷰 컨트롤러
    - 씬을 표현하는 역할 대신, 다른 뷰 컨트롤러의 연결 관계를 관리.
    - ex. 네비게이션 컨트롤러, 탭 바 컨트롤러 등.
    - 뷰를 포함하고 있지 않다.
- 뷰 계층 구조
    - 슈퍼뷰와 서브뷰
    - 다른 뷰를 포함하는 뷰는 슈퍼뷰, 포함된 뷰는 서브뷰.
    - 해당 계층 구분은 상대적이다. (슈퍼뷰 역시 다른 뷰의 서브뷰가 될 수 있다.)
- 뷰 컨트롤러
    - 앱의 근간을 이루는 객체.
    - 모든 앱은 하나 이상의 뷰 컨트롤러로 구성된다.
    - 주된 역할 :  화면 구성 요소들인 뷰를 관리.
    - 추가적 역할 : 화면과 데이터 사이의 상호작용 관리.
- 뷰 컨트롤러의 상태 변화와 생명 주기
    - 뷰 컨트롤러도 생명 주기와 상태 변화를 가진다. (앱 전체의 생명주기와 별개로.)
    - 씬의 전환과 복귀에 밀접하게 연관되어 있다.
    - 특정 상태 변화를 일으킬 때 호출하는 메소드들이 지정되어 있다. (앱 델리게이트가 아닌 뷰 컨트롤러에 정의되어 있음.)
        1. Appearing : 뷰 컨트롤러가 스크린에 등장하기 시작한 순간부터 완료 직전까지.
        2. Appeared : 뷰 컨트롤러가 스크린 전체에 완전히 등장한 상태.
        3. Disappearing : 뷰 컨트롤러가 스크린에서 가려지기 시작해서 완전히 가려지기 직전까지.
        4. Disappeared : 뷰 컨트롤러가 스크린에서 완전히 가려졌거나 퇴장한 상태.
