# 12강 탭 바 컨트롤러

- 탭 바 컨트롤러
    - 수평적 관계의 독립된 각 화면에 바로 접근할 수 있도록 탭 바를 제공하는 컨트롤러
    - 컨테이너 컨트롤러 타입(직접 콘텐츠를 표현하지 않으면서 다른 뷰 컨트롤러를 유기적인 관계로 제어하는 역할)
    - 스토리보드 맨 앞보다 위치. (내비게이션 컨트롤러보다도)
    - UITabBarController 클래스에 정의
    - 커스터마이징하려면 UITabBarController 상속 필요
    - 관계형 세그웨이 : 탭 바 컨트롤러와 뷰 컨트롤러 사이의 연결고리
    - 배지 표시 : tabBarItem.badgeValue 로 동적 처리
- 예제
    
    ```swift
    //
    //  TheaterCell.swift
    //  MyMovieChart-1
    //
    //  Created by 이형주 on 2022/05/18.
    //
    
    import Foundation
    import UIKit
    
    class TheaterCell: UITableViewCell{
        
    // 커스텀 셀 레이블들에 아울렛 변수 연결
        @IBOutlet weak var name: UILabel!
        @IBOutlet weak var tel: UILabel!
        @IBOutlet weak var addr: UILabel!
    }
    ```
    
    ```swift
    //
    //  TheaterListController.swift
    //  MyMovieChart-1
    //
    //  Created by 이형주 on 2022/05/18.
    //
    
    import Foundation
    import UIKit
    
    class TheaterListController: UITableViewController{
        var list = [NSDictionary]()
    
    // 데이터의 시작 위치를 직접 지정
        var startPoint = 0
        
        override func viewDidLoad() {
            self.callTheaterAPI()
        }
        
        func callTheaterAPI() {
            
            let requestURI = "http://swiftapi.rubypaper.co.kr:2029/theater/list"
            let sList = 100
            let type = "json"
            
            let ur10bj = URL(string: "\(requestURI)?s_page=\(self.startPoint)&s_list=\(sList)&type=\(type)")
            
            do {
    
    // 제일 중요한 코드 : API 호출해 데이터 로딩
    // 이전처럼 바로 .data로 읽지 않는 이유 : 이번 API는 utf-8이 아닌 EUC-KR 이라서.
                let stringData = try NSString(contentsOf: ur10bj!, encoding: 0x80_000_422)
                let encData = stringData.data(using: String.Encoding.utf8.rawValue)
                
                do {
    // 전달받은 데이터를 파싱하면 최상위 객체가 JSON 객체{} 가 아닌 JSON 배열[]타입으로 작성
    // 따라서 NSDictionary가 아닌 NSArray로 캐스팅
    
                    let apiArray = try JSONSerialization.jsonObject(with: encData!, options: []) as? NSArray
                    for obj in apiArray! {
                        self.list.append(obj as! NSDictionary)
                    }
                } catch {
                    let alert = UIAlertController(title: "실패", message: "데이터 분석 실패", preferredStyle: .alert)
                    alert.addAction(UIAlertAction(title: "ok", style: .cancel))
                    self.present(alert, animated: true)
                }
    // 데이터를 읽고 난 후 다음번 데이터의 시작점을 미리 연산하여 저장해 놓는 방식이 되야되므로 
    // do-try 바깥 맨 아래에 위치. (파싱 실패하더라도 데이터를 정상적으로 읽어들이도록.)
                self.startPoint += sList
                
            } catch {
            let alert = UIAlertController(title: "실패", message: "데이터 호출 실패", preferredStyle: .alert)
            alert.addAction(UIAlertAction(title: "확인", style: .cancel))
            self.present(alert, animated: true)
            }
        
        }
    
        override func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
            return self.list.count
        }
        
        override func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
            let obj = self.list[indexPath.row]
            let cell = tableView.dequeueReusableCell(withIdentifier: "tCell") as! TheaterCell
            
            cell.name?.text = obj["상영관명"] as? String
            cell.tel?.text = obj["연락처"] as? String
            cell.addr?.text = obj["소재지도로명주소"] as? String
            
            return cell
        }
    }
    ```
    
    - EUC-KR
        - EUC-KR은 한글을 2byte로 변환하는 인코딩 방법
        - UTF-8 과 달리 데이터를 읽어올 때 인코딩 필요
        - 바로 Data 객체로 못넘어가고, 인코딩 처리가 가능한 NSString으로 반환 후 Data 객체로.
        - 예시의 0x80_000_422는 EUC-KR 인코딩에 해당하는 16진수값.
